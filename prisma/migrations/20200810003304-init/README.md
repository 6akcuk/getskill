# Migration `20200810003304-init`

This migration has been generated by Denis at 8/10/2020, 12:33:04 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `getskill-mvp`.`User` (
`id` int NOT NULL  AUTO_INCREMENT,
`email` varchar(191) NOT NULL ,
`password` varchar(191) NOT NULL ,
`phone` varchar(191)  ,
`role` ENUM('USER', 'MODERATOR', 'ADMIN') NOT NULL DEFAULT 'USER',
`isEmailVerified` boolean NOT NULL DEFAULT false,
`isPhoneVerified` boolean NOT NULL DEFAULT false,
`vkontakteId` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `getskill-mvp`.`UserToken` (
`id` int NOT NULL  AUTO_INCREMENT,
`token` varchar(191) NOT NULL ,
`deviceId` varchar(191) NOT NULL ,
`ip` int NOT NULL ,
`isValid` boolean NOT NULL DEFAULT true,
`userId` int NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `getskill-mvp`.`Profile` (
`id` int NOT NULL  AUTO_INCREMENT,
`publicName` varchar(191) NOT NULL ,
`avatar` varchar(191)  ,
`contacts` json NOT NULL ,
`userId` int NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.email` ON `getskill-mvp`.`User`(`email`)

CREATE UNIQUE INDEX `User.phone` ON `getskill-mvp`.`User`(`phone`)

CREATE UNIQUE INDEX `User.vkontakteId` ON `getskill-mvp`.`User`(`vkontakteId`)

CREATE UNIQUE INDEX `Profile_userId` ON `getskill-mvp`.`Profile`(`userId`)

ALTER TABLE `getskill-mvp`.`UserToken` ADD FOREIGN KEY (`userId`) REFERENCES `getskill-mvp`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `getskill-mvp`.`Profile` ADD FOREIGN KEY (`userId`) REFERENCES `getskill-mvp`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200810003304-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,48 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "mysql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum Role {
+  USER
+  MODERATOR
+  ADMIN
+}
+
+model User {
+  id Int @default(autoincrement()) @id
+  email String @unique
+  password String
+  phone String? @unique
+  role Role @default(USER)
+  isEmailVerified Boolean @default(false)
+  isPhoneVerified Boolean @default(false)
+  vkontakteId String? @unique
+  profile Profile
+}
+
+model UserToken {
+  id Int @default(autoincrement()) @id
+  token String
+  deviceId String
+  ip Int
+  isValid Boolean @default(true)
+  user User @relation(fields: [userId], references: [id])
+  userId Int
+}
+
+model Profile {
+  id Int @default(autoincrement()) @id
+  publicName String
+  avatar String?
+  contacts Json
+  user User @relation(fields: [userId], references: [id])
+  userId Int
+}
```


